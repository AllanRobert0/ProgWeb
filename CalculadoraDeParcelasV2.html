<html>
   

    <body>

       <h1>Calculadora de Parcelas</h1>

       <div>
           <div class="main-Inputs">
                Juros Por Mes (%)
                <input type="number" id="numJuros">  
            </div> 

            <div class="mainInputs">
                Multa Por Atraso (%)
                <input type="number" id="numMultaAtraso">  
            </div>  

            <div class="mainInputs">
                Data Atual
                <input type="date" id="dataAtual">
            </div>
        </div>



        <div id="container-linhas">

        </div>

        <div id="kk">        
            <div class="somasTotais" id="somaMultas">
                Total Multas: -
            </div>

            <div class="somasTotais" id="somaDias">
                Total Dias de Atraso: -
            </div>

            <div class="somasTotais" id="somaJuros">
                Total Juros: -
            </div>

            <div class="somasTotais" id="somaTotais">
                Total a Pagar: -
            </div>
        </div>

       <button onclick="AdicionarLinha()">Adicionar Linha</button>
       <button onclick="Calcular()">Calcular</button>
       <button onclick="TESTE()">TESTE</button>
       


    </body>

    <head>

        <style>
            .Itemlinha {
                display: inline-block;
                width: 180px;
                height: 50px;
                padding: 5px;
                border: 2px solid;
            }
            .main-Inputs{
                margin-bottom: 10px;                
                margin-top: 10px;
               
                border: 10px;
            }
            .somasTotais{
                display: inline-block;
               margin-left: 70px; 
            }
        </style>

        <script>
            let contLinha = -1;
            let i = 0;
            const linha = () =>{
                
                return(`
                
                    <div class="Itemlinha">
                        <div>Valor da Parcela (R$)</div>
                
                        <div>
                            <input type="number" class="numValorParcela">
                        </div>
                    </div>
                    <div class="Itemlinha">
                        <div>Data de Vencimento</div>
                        <div>
                            <input type="date" class="dataVencimento">
                        </div>
                    </div>
                    <div class="Itemlinha" >
                        <div>Multa (R$)</div>
                        <div>
                            <div class="totalMulta">-</div>
                        </div>
                    </div>
                    <div class="Itemlinha">
                        <div>Dias de Atraso</div>
                        <div>
                            <div class="diasAtraso">-</div>
                        </div>
                    </div>
                    <div class="Itemlinha" >
                        <div>Juros (R$)</div>
                        <div>
                            <div class="totalJuros">-</div>
                        </div>
                    </div>
                    <div class="Itemlinha" >
                        <div>Total (R$)</div>
                        <div>
                            <div class="totalPagar">-</div>
                        </div>
                    </div>
                    <button onclick="Remover(this)">REMOVER</button>
                `);
            }

            function Remover(botao){
                //console.log(typeof botao);
                //console.log(botao);
                //botao.remove();

               console.log(botao.parentNode);
               botao.parentNode.remove();
            }


            function AdicionarLinha(){                
                let novaLinha = document.createElement("div");
                novaLinha.className = "linha";
                novaLinha.innerHTML = linha();
                document.getElementById("container-linhas").appendChild(novaLinha);
                contLinha++;
            }
            function Calcular(){
                let somaMulta = 0;
                let somaDias  = 0;
                let somaJuros = 0;
                let somaTotal = 0;
                
                let jurosPorMes = parseFloat(document.getElementById("numJuros").value).toFixed(2);
                let numMultaPorAtraso = parseFloat(document.getElementById("numMultaAtraso").value).toFixed(2);
                let dataAtual = new Date(document.getElementById("dataAtual").value);
                let numValorParcela = document.getElementsByClassName("numValorParcela");
                let dataVencimento = document.getElementsByClassName("dataVencimento");
                
                for(i=0 ; i <= contLinha; i++){

                    let diasAtraso = ((dataAtual - dataVencimento[i].valueAsDate)/86400000).toFixed(2); //FÃ³rmula: divida o valor de tempo(ms) por 8,64e+7
                    let totaljuros =(  (((jurosPorMes/30)/100)*numValorParcela[i].value) * diasAtraso).toFixed(2);//j por mes acrescentado por dia
                    let totalMultaPorAtraso = ((numMultaPorAtraso/100)*numValorParcela[i].value).toFixed(2);
                    let totalPagar = ( parseFloat(totaljuros)  +  parseFloat(totalMultaPorAtraso) + parseFloat(numValorParcela[i].value));

                    document.getElementsByClassName("totalMulta")[i].innerHTML = totalMultaPorAtraso;
                    document.getElementsByClassName("diasAtraso")[i].innerHTML = diasAtraso;
                    document.getElementsByClassName("totalJuros")[i].innerHTML = totaljuros;
                    document.getElementsByClassName("totalPagar")[i].innerHTML = totalPagar;

                    
                    somaDias  += parseFloat(diasAtraso) ;
                    somaMulta += parseFloat(totalMultaPorAtraso);
                    somaJuros += parseFloat(totaljuros);
                    somaTotal += parseFloat(totalPagar);
                }

                document.getElementById("somaMultas").innerHTML = "Total Multas: "+somaMulta;
                document.getElementById("somaDias").innerHTML = "Total Dias de Atraso: "+somaDias;
                document.getElementById("somaJuros").innerHTML = "Total Juros: "+somaJuros;
                document.getElementById("somaTotais").innerHTML = "Total a Pagar: "+somaTotal;
               
            }
            AdicionarLinha();
        </script>

    </head>
</html>